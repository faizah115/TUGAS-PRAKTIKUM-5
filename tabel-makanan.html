<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daftar Makanan Khas Sulawesi Selatan</title>
    <link rel="stylesheet" href="assets/style.css">
</head>
<body>
    <header>Makanan Khas</header>
    <div class="container">
        <aside class="sidebar">
            <nav>
                <ul>
                    <li><a href="#">Dashboard</a></li>
                    <li><a href="tabel-makanan.html">Makanan Khas</a></li>
                    <li><a href="objek-wisata.html">Objek Wisata</a></li> <li>
                    <a href="#">Keluar</a></li>
                </ul>
            </nav>
        </aside>

        <section class="content">
            <h1>Daftar Makanan Khas Sulawesi Selatan</h1>

            <form id="food-form">
                <h2>Tambah Makanan Khas</h2>
                <label for="food-name">Nama Makanan:</label>
                <input type="text" id="food-name" placeholder="Masukkan nama makanan...">

                <label for="food-desc">Deskripsi Makanan:</label>
                <input type="text" id="food-desc" placeholder="Masukkan deskripsi makanan...">

                <label for="food-image">Gambar Makanan:</label>
                <input type="file" id="food-image">

                <div class="add-button">
                    <button type="submit" id="submit-btn">Tambah</button>
                </div>
            </form>

            <table id="food-table">
                <thead>
                    <tr>
                        <th>No</th>
                        <th>Nama Makanan</th>
                        <th>Gambar</th>
                        <th>Deskripsi</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>Coto Makassar</td>
                        <td><img src="assets/coto-makassar.jpg" alt="Coto Makassar" width="80"></td>
                        <td>Hidangan sup tradisional khas Makassar, terbuat dari daging sapi dan rempah khas.</td>
                        <td>
                            <button class="edit-btn" onclick="editRow(this)">Edit</button>
                            <button class="delete-btn" onclick="deleteRow(this)">Hapus</button>
                        </td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Pallubasa</td>
                        <td><img src="assets/pallubasa.jpg" alt="Pallubasa" width="80"></td>
                        <td>Makanan khas Makassar mirip Coto Makassar, namun menggunakan kelapa parut.</td>
                        <td>
                            <button class="edit-btn" onclick="editRow(this)">Edit</button>
                            <button class="delete-btn" onclick="deleteRow(this)">Hapus</button>
                        </td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Pisang Ijo</td>
                        <td><img src="assets/pisang-ijo.jpg" alt="Pisang Ijo" width="80"></td>
                        <td>Hidangan penutup berbahan dasar pisang yang dibalut adonan hijau.</td>
                        <td>
                            <button class="edit-btn" onclick="editRow(this)">Edit</button>
                            <button class="delete-btn" onclick="deleteRow(this)">Hapus</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
    </div>

    <script>
    const foodForm = document.getElementById('food-form');
    const foodTable = document.getElementById('food-table').getElementsByTagName('tbody')[0];
    const submitBtn = document.getElementById('submit-btn');

    let editRowIndex = null; 

    foodForm.addEventListener('submit', function(e){
        e.preventDefault();
        const foodName = document.getElementById('food-name').value;
        const foodDesc = document.getElementById('food-desc').value;
        const foodImage = document.getElementById('food-image').files[0];

        if(foodName && foodDesc && (foodImage || editRowIndex !== null)){
            if(editRowIndex !== null){
                const row = foodTable.rows[editRowIndex];
                row.cells[1].textContent = foodName;
                row.cells[3].textContent = foodDesc;

                if(foodImage){
                    const reader = new FileReader();
                    reader.onload = function(e){
                        row.cells[2].innerHTML = `<img src="${e.target.result}" width="80">`;
                    };
                    reader.readAsDataURL(foodImage);
                }

                submitBtn.textContent = "Tambah";
                editRowIndex = null;
            } 
            else {
                const newRow = foodTable.insertRow();
                const cellNo = newRow.insertCell(0);
                const cellName = newRow.insertCell(1);
                const cellImage = newRow.insertCell(2);
                const cellDesc = newRow.insertCell(3);
                const cellAction = newRow.insertCell(4);

                cellNo.textContent = foodTable.rows.length;
                cellName.textContent = foodName;

                const reader = new FileReader();
                reader.onload = function(e){
                    cellImage.innerHTML = `<img src="${e.target.result}" width="80">`;
                };
                reader.readAsDataURL(foodImage);

                cellDesc.textContent = foodDesc;
                cellAction.innerHTML = `
                    <button class="edit-btn" onclick="editRow(this)">Edit</button>
                    <button class="delete-btn" onclick="deleteRow(this)">Hapus</button>
                `;
            }

            foodForm.reset();
        } else {
            alert("Nama, Deskripsi, dan Gambar harus diisi.");
        }
    });

    function deleteRow(button){
    if(confirm('Apakah Anda yakin ingin menghapus makanan ini?')) {
        const row = button.parentElement.parentElement;
        row.remove();
        const rows = foodTable.rows;
        for(let i=0; i<rows.length; i++){
            rows[i].cells[0].textContent = i+1;
        }
    }
}

    function editRow(button){
        const row = button.parentElement.parentElement;
        editRowIndex = row.rowIndex - 1;

        document.getElementById('food-name').value = row.cells[1].textContent;
        document.getElementById('food-desc').value = row.cells[3].textContent;

        submitBtn.textContent = "Simpan";
    }
</script>

</body>
</html>
